<?xml version="1.0"?>  
<!-- This file was generated by xacro from rf_hybrid_arm.urdf. -->  
<robot name="rf_hybrid_arm" xmlns:xacro="http://www.ros.org/wiki/xacro">
    <!-- 封装变量、常量 -->
    <xacro:property name="PI" value="3.14159"/>
    <!-- 宏:颜色设置 -->
    <material name="color_linkages">
        <!-- 黑色 -->
        <color rgba="0.0 0.0 0.0 1.0" />
    </material>
    <material name="color_base">
        <!-- 棕色 --> 
        <color rgba="0.5 0.25 0.0 1.0" />
    </material>

    <!-- 导入数据config -->
    <xacro:property name="carm_config_file" value="$(find standard_cr_description)/config/rf_hybrid_arm_config.yaml" />
    <xacro:property name="carm_props" value="${xacro.load_yaml(carm_config_file)}"/>
    <!-- 命名数据变量 -->
    <xacro:property name="cm_prefix" value="${carm_props['structure_parameters']['cm']['prefix']}"/>
    <xacro:property name="ee_prefix" value="ee"/>
    <xacro:property name="cm_length" value="${carm_props['structure_parameters']['cm']['length']}"/>
    <xacro:property name="cm_diameter" value="${carm_props['structure_parameters']['cm']['diameter']}"/>
    <xacro:property name="cm_num_linkages" value="${carm_props['structure_parameters']['cm']['num_linkages']}"/>
    
    <!-- transmisioons -->
    <xacro:include filename="$(find standard_cr_description)/urdf/transmissions/rf_hybrid_arm_transmissions.xacro" />
    <xacro:rf_hybrid_arm_transmissions  hw_interface="hardware_interface/PositionJointInterface"/>

    <!-- 刚性关节 -->
    <!-- 导入刚性关节文件 -->
    <xacro:include filename="$(find rigid_arm_3dof)/urdf/rigid_arm_3dof.urdf" />
    <rigid_arm_3dof />

    <!-- 刚性关节和柔性关节之间的fixed关节 -->
    <joint name="fixed_joint_rtof" type="fixed">
        <origin xyz="0 -0.14 0.12" rpy="${PI/2} ${PI/4} 0" />
        <parent link="rigid4_link" />
        <child link="${cm_prefix}_base" />
    </joint>

    <!-- 连续体模块 -->
    <!-- 导入连续体模块文件 -->
    <xacro:include filename="$(find standard_cr_description)/urdf/continuum_module/continuum_module_2dof.xacro" />
    <!-- 导入连续体xacro -->
    <xacro:cm_2dof prefix="${cm_prefix}" TotalLength="${cm_length}" Diameter="${cm_diameter}" Num_linkages="${cm_num_linkages}"/>

    <!-- 连续体模块和末端旋转盘之间的fixed关节 -->
    <joint name="fixed_joint_cmtoq6" type="fixed">
        <origin xyz="0 0 0" rpy="0 0 ${PI/4}" />        
        <parent link="${cm_prefix}_link_end"/>
        <child link="q6_base" />
    </joint>

    <!-- 末端旋转盘 -->
    <!-- 导入末端旋转盘 -->
    <link name="q6_base">   
        <visual>
            <origin xyz="0 0 0.015" rpy="0 0 0"/>
            <geometry>
                <cylinder length="0.03" radius="0.015"/>
            </geometry>
            <material name="color_linkages" />
        </visual>
    </link>
    <joint name="q6" type="revolute">
        <origin xyz="0 0 0.03" rpy="0 0 ${PI/2}" />        
        <parent link="q6_base"/>
        <child link="ee_interface" />
        <limit effort="1000.0" lower="${-PI/2}" upper="${PI/2}" velocity="0.5"/>
        <axis xyz="0 0 1"/>
    </joint> 
    <link name="ee_interface"/>
    
    <!-- 末端旋转盘和末端接口之间的fixed关节 -->
    <joint name="fixed_joint_q6toee" type="fixed">      
        <parent link="ee_interface"/>
        <child link="${ee_prefix}_base" />
    </joint> 
    
    <!-- 夹爪 -->
    <!-- 参考robotiq_arg2f_85.xacro导入夹爪文件 -->
    <!-- ref:https://zhuanlan.zhihu.com/p/652684467 -->
    <xacro:include filename="$(find robotiq_2f_85_gripper_visualization)/urdf/robotiq_arg2f_85_macro.xacro" />
    <xacro:arg name="ee_transmission_hw_interface" default="hardware_interface/EffortJointInterface"/>
    <!-- 导入夹爪 -->
    <xacro:robotiq_arg2f_85 
        prefix="${ee_prefix}"
        transmission_hw_interface="$(arg ee_transmission_hw_interface)"/>


</robot>